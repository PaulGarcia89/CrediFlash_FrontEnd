{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/paulgarcia/Documents/ProyectosDesarrollo/ReactCrediFlash/ReactCrediFlash/material-dashboard-pro-react/crediflash-vuexy-next/src/lib/auth/session.js"],"sourcesContent":["const TOKEN_KEY = 'cf_token'\nconst USER_KEY = 'cf_analista'\n\nconst isBrowser = () => typeof window !== 'undefined'\n\nexport const setSession = ({ token, analista }) => {\n  if (!isBrowser()) return\n\n  if (token) {\n    window.localStorage.setItem(TOKEN_KEY, token)\n    window.localStorage.setItem('token', token)\n    window.localStorage.setItem('accessToken', token)\n    window.localStorage.setItem('authToken', token)\n    document.cookie = `${TOKEN_KEY}=${token}; path=/; max-age=28800; samesite=lax`\n  }\n\n  if (analista) {\n    window.localStorage.setItem(USER_KEY, JSON.stringify(analista))\n  }\n}\n\nexport const getToken = () => {\n  if (!isBrowser()) return ''\n\n  return (\n    window.localStorage.getItem(TOKEN_KEY) ||\n    window.localStorage.getItem('token') ||\n    window.localStorage.getItem('accessToken') ||\n    window.localStorage.getItem('authToken') ||\n    ''\n  )\n}\n\nexport const getAnalista = () => {\n  if (!isBrowser()) return null\n\n  const raw = window.localStorage.getItem(USER_KEY)\n\n  if (!raw) return null\n\n  try {\n    return JSON.parse(raw)\n  } catch {\n    return null\n  }\n}\n\nexport const clearSession = () => {\n  if (!isBrowser()) return\n\n  window.localStorage.removeItem(TOKEN_KEY)\n  window.localStorage.removeItem(USER_KEY)\n  window.localStorage.removeItem('token')\n  window.localStorage.removeItem('accessToken')\n  window.localStorage.removeItem('authToken')\n\n  document.cookie = `${TOKEN_KEY}=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT`\n}\n\nexport const isAuthenticated = () => Boolean(getToken())\n"],"names":[],"mappings":";;;;;;;;;;;;AAAA,MAAM,YAAY;AAClB,MAAM,WAAW;AAEjB,MAAM,YAAY,IAAM,kDAAkB;AAEnC,MAAM,aAAa,CAAC,EAAE,KAAK,EAAE,QAAQ,EAAE;IAC5C,IAAI,CAAC,aAAa;;;AAapB;AAEO,MAAM,WAAW;IACtB,IAAI,CAAC,aAAa,OAAO;;;AAS3B;AAEO,MAAM,cAAc;IACzB,IAAI,CAAC,aAAa,OAAO;;;IAEzB,MAAM;AASR;AAEO,MAAM,eAAe;IAC1B,IAAI,CAAC,aAAa;;;AASpB;AAEO,MAAM,kBAAkB,IAAM,QAAQ"}},
    {"offset": {"line": 45, "column": 0}, "map": {"version":3,"sources":["file:///Users/paulgarcia/Documents/ProyectosDesarrollo/ReactCrediFlash/ReactCrediFlash/material-dashboard-pro-react/crediflash-vuexy-next/src/api/http.js"],"sourcesContent":["import { clearSession } from '@/lib/auth/session'\n\nconst API_BASE_URL = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:5001/api'\n\nconst TOKEN_KEYS = ['cf_token', 'accessToken', 'token', 'authToken']\n\nconst getToken = () => {\n  if (typeof window === 'undefined') return null\n\n  for (const key of TOKEN_KEYS) {\n    const value = window.localStorage.getItem(key)\n\n    if (value) return value\n  }\n\n  return null\n}\n\nconst buildUrl = (path, query) => {\n  const normalizedBase = API_BASE_URL.endsWith('/') ? API_BASE_URL.slice(0, -1) : API_BASE_URL\n  const normalizedPath = path.startsWith('/') ? path : `/${path}`\n  const url = new URL(`${normalizedBase}${normalizedPath}`)\n\n  if (query) {\n    Object.entries(query).forEach(([key, value]) => {\n      if (value !== undefined && value !== null && value !== '') {\n        url.searchParams.set(key, String(value))\n      }\n    })\n  }\n\n  return url.toString()\n}\n\nexport const apiRequest = async (path, { method = 'GET', query, body, auth = true } = {}) => {\n  const headers = {\n    'Content-Type': 'application/json'\n  }\n\n  if (auth) {\n    const token = getToken()\n\n    if (token) {\n      headers.Authorization = `Bearer ${token}`\n    }\n  }\n\n  let response\n\n  try {\n    response = await fetch(buildUrl(path, query), {\n      method,\n      headers,\n      body: body ? JSON.stringify(body) : undefined,\n      cache: 'no-store'\n    })\n  } catch {\n    throw new Error('No se pudo conectar con el backend en http://localhost:5001')\n  }\n\n  const payload = await response.json().catch(() => ({}))\n\n  if (!response.ok) {\n    if (response.status === 401 || response.status === 403) {\n      clearSession()\n    }\n\n    const message = payload?.message || payload?.error || `HTTP ${response.status}`\n    const error = new Error(message)\n\n    error.status = response.status\n    error.payload = payload\n\n    throw error\n  }\n\n  return payload\n}\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,eAAe,QAAQ,GAAG,CAAC,mBAAmB,IAAI;AAExD,MAAM,aAAa;IAAC;IAAY;IAAe;IAAS;CAAY;AAEpE,MAAM,WAAW;IACf,wCAAmC,OAAO;;;IAErC,MAAM;AAOb;AAEA,MAAM,WAAW,CAAC,MAAM;IACtB,MAAM,iBAAiB,aAAa,QAAQ,CAAC,OAAO,aAAa,KAAK,CAAC,GAAG,CAAC,KAAK;IAChF,MAAM,iBAAiB,KAAK,UAAU,CAAC,OAAO,OAAO,CAAC,CAAC,EAAE,MAAM;IAC/D,MAAM,MAAM,IAAI,IAAI,GAAG,iBAAiB,gBAAgB;IAExD,IAAI,OAAO;QACT,OAAO,OAAO,CAAC,OAAO,OAAO,CAAC,CAAC,CAAC,KAAK,MAAM;YACzC,IAAI,UAAU,aAAa,UAAU,QAAQ,UAAU,IAAI;gBACzD,IAAI,YAAY,CAAC,GAAG,CAAC,KAAK,OAAO;YACnC;QACF;IACF;IAEA,OAAO,IAAI,QAAQ;AACrB;AAEO,MAAM,aAAa,OAAO,MAAM,EAAE,SAAS,KAAK,EAAE,KAAK,EAAE,IAAI,EAAE,OAAO,IAAI,EAAE,GAAG,CAAC,CAAC;IACtF,MAAM,UAAU;QACd,gBAAgB;IAClB;IAEA,IAAI,MAAM;QACR,MAAM,QAAQ;QAEd,IAAI,OAAO;YACT,QAAQ,aAAa,GAAG,CAAC,OAAO,EAAE,OAAO;QAC3C;IACF;IAEA,IAAI;IAEJ,IAAI;QACF,WAAW,MAAM,MAAM,SAAS,MAAM,QAAQ;YAC5C;YACA;YACA,MAAM,OAAO,KAAK,SAAS,CAAC,QAAQ;YACpC,OAAO;QACT;IACF,EAAE,OAAM;QACN,MAAM,IAAI,MAAM;IAClB;IAEA,MAAM,UAAU,MAAM,SAAS,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC,CAAC,CAAC;IAErD,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,IAAI,SAAS,MAAM,KAAK,OAAO,SAAS,MAAM,KAAK,KAAK;YACtD,IAAA,4KAAY;QACd;QAEA,MAAM,UAAU,SAAS,WAAW,SAAS,SAAS,CAAC,KAAK,EAAE,SAAS,MAAM,EAAE;QAC/E,MAAM,QAAQ,IAAI,MAAM;QAExB,MAAM,MAAM,GAAG,SAAS,MAAM;QAC9B,MAAM,OAAO,GAAG;QAEhB,MAAM;IACR;IAEA,OAAO;AACT"}},
    {"offset": {"line": 115, "column": 0}, "map": {"version":3,"sources":["file:///Users/paulgarcia/Documents/ProyectosDesarrollo/ReactCrediFlash/ReactCrediFlash/material-dashboard-pro-react/crediflash-vuexy-next/src/api/clientes.js"],"sourcesContent":["import { apiRequest } from './http'\n\nexport const listarClientes = ({ page = 1, limit = 20, search = '', estado = 'ACTIVO' } = {}) =>\n  apiRequest('/clientes', {\n    method: 'GET',\n    query: { page, limit, search, estado }\n  })\n\nexport const verHistorialPrestamosCliente = (clienteId, { page = 1, limit = 20 } = {}) =>\n  apiRequest(`/clientes/${clienteId}/prestamos`, {\n    method: 'GET',\n    query: { page, limit }\n  })\n"],"names":[],"mappings":";;;;;;AAAA;;AAEO,MAAM,iBAAiB,CAAC,EAAE,OAAO,CAAC,EAAE,QAAQ,EAAE,EAAE,SAAS,EAAE,EAAE,SAAS,QAAQ,EAAE,GAAG,CAAC,CAAC,GAC1F,IAAA,+JAAU,EAAC,aAAa;QACtB,QAAQ;QACR,OAAO;YAAE;YAAM;YAAO;YAAQ;QAAO;IACvC;AAEK,MAAM,+BAA+B,CAAC,WAAW,EAAE,OAAO,CAAC,EAAE,QAAQ,EAAE,EAAE,GAAG,CAAC,CAAC,GACnF,IAAA,+JAAU,EAAC,CAAC,UAAU,EAAE,UAAU,UAAU,CAAC,EAAE;QAC7C,QAAQ;QACR,OAAO;YAAE;YAAM;QAAM;IACvB"}},
    {"offset": {"line": 143, "column": 0}, "map": {"version":3,"sources":["file:///Users/paulgarcia/Documents/ProyectosDesarrollo/ReactCrediFlash/ReactCrediFlash/material-dashboard-pro-react/crediflash-vuexy-next/src/views/modules/ClientesModule.jsx"],"sourcesContent":["'use client'\n\nimport { useCallback, useEffect, useMemo, useState } from 'react'\n\nimport Alert from '@mui/material/Alert'\nimport Box from '@mui/material/Box'\nimport Card from '@mui/material/Card'\nimport CardContent from '@mui/material/CardContent'\nimport CircularProgress from '@mui/material/CircularProgress'\nimport Pagination from '@mui/material/Pagination'\nimport Stack from '@mui/material/Stack'\nimport Table from '@mui/material/Table'\nimport TableBody from '@mui/material/TableBody'\nimport TableCell from '@mui/material/TableCell'\nimport TableHead from '@mui/material/TableHead'\nimport TableRow from '@mui/material/TableRow'\nimport TextField from '@mui/material/TextField'\nimport Typography from '@mui/material/Typography'\n\nimport { listarClientes } from '@/api/clientes'\n\nconst extractRows = payload => {\n  if (Array.isArray(payload)) return payload\n  if (Array.isArray(payload?.data)) return payload.data\n  if (Array.isArray(payload?.rows)) return payload.rows\n  if (Array.isArray(payload?.data?.rows)) return payload.data.rows\n\n  return []\n}\n\nconst extractPagination = payload => {\n  const source = payload?.pagination || payload?.data?.pagination\n\n  return {\n    page: Number(source?.page || 1),\n    pages: Number(source?.pages || 1),\n    total: Number(source?.total || extractRows(payload).length)\n  }\n}\n\nexport default function ClientesModule() {\n  const [clientes, setClientes] = useState([])\n  const [loading, setLoading] = useState(true)\n  const [error, setError] = useState('')\n  const [search, setSearch] = useState('')\n  const [page, setPage] = useState(1)\n  const [pagination, setPagination] = useState({ page: 1, pages: 1, total: 0 })\n\n  const loadClientes = useCallback(async () => {\n    setLoading(true)\n    setError('')\n\n    try {\n      const response = await listarClientes({ page, limit: 20, search, estado: 'ACTIVO' })\n\n      setClientes(extractRows(response))\n      setPagination(extractPagination(response))\n    } catch (err) {\n      setError(err.message || 'No se pudo cargar clientes.')\n    } finally {\n      setLoading(false)\n    }\n  }, [page, search])\n\n  useEffect(() => {\n    const timeout = setTimeout(() => {\n      loadClientes()\n    }, 300)\n\n    return () => clearTimeout(timeout)\n  }, [loadClientes])\n\n  useEffect(() => {\n    setPage(1)\n  }, [search])\n\n  const rows = useMemo(() => clientes || [], [clientes])\n\n  return (\n    <Card>\n      <CardContent>\n        <Stack spacing={3}>\n          <Box>\n            <Typography variant='h4'>Clientes</Typography>\n            <Typography color='text.secondary'>Listado de clientes activos.</Typography>\n          </Box>\n\n          <TextField\n            label='Buscar cliente'\n            placeholder='Nombre, apellido, teléfono o email'\n            value={search}\n            onChange={event => setSearch(event.target.value)}\n            size='small'\n          />\n\n          {error ? <Alert severity='error'>{error}</Alert> : null}\n\n          {loading ? (\n            <Stack alignItems='center' py={8}>\n              <CircularProgress size={28} />\n            </Stack>\n          ) : (\n            <Table size='small'>\n              <TableHead>\n                <TableRow>\n                  <TableCell>Nombre</TableCell>\n                  <TableCell>Apellido</TableCell>\n                  <TableCell>Email</TableCell>\n                  <TableCell>Teléfono</TableCell>\n                  <TableCell>Estado</TableCell>\n                </TableRow>\n              </TableHead>\n              <TableBody>\n                {rows.map(row => (\n                  <TableRow key={row.id} hover>\n                    <TableCell>{row.nombre || '-'}</TableCell>\n                    <TableCell>{row.apellido || '-'}</TableCell>\n                    <TableCell>{row.email || '-'}</TableCell>\n                    <TableCell>{row.telefono || '-'}</TableCell>\n                    <TableCell>{row.estado || '-'}</TableCell>\n                  </TableRow>\n                ))}\n                {rows.length === 0 ? (\n                  <TableRow>\n                    <TableCell colSpan={5} align='center'>\n                      Sin resultados\n                    </TableCell>\n                  </TableRow>\n                ) : null}\n              </TableBody>\n            </Table>\n          )}\n\n          <Stack direction='row' justifyContent='space-between' alignItems='center'>\n            <Typography color='text.secondary'>Total: {pagination.total}</Typography>\n            <Pagination\n              page={pagination.page}\n              count={Math.max(pagination.pages, 1)}\n              onChange={(_, value) => setPage(value)}\n              size='small'\n              color='primary'\n            />\n          </Stack>\n        </Stack>\n      </CardContent>\n    </Card>\n  )\n}\n"],"names":[],"mappings":"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"}}]
}